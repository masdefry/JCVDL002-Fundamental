<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=], initial-scale=1.0">
    <title>Parking Apps V.1.0</title>
</head>
<body>
    <script>
        // Step1. Identifikasi Data
        // Jam Masuk, Waktu Masuk, Tanggal Masuk || Jam Keluar, Waktu Keluar, Tanggal Keluar
        // Lama Parkir, Tarif Parkir, Uang yg Dibayarkan, Struk Pembayaran

        // Step2. Terima Input dari User, Lalu Kita Validasi
        // Validasi Jam, Waktu & Tanggal. Dengan Ketentuan:
        //      - Jam Keluar Tidak Boleh < Jam Masuk Ketika di Tanggal & Waktu yg Sama
        //      - Tanggal Keluar Tidak Boleh < Tanggal Masuk
        //      - Durasi Parkir Tidak Boleh > 24 Jam

        let jamMasuk
        do{
            jamMasuk = prompt("Silahkan Masukan Jam Masuk (Ex. 1-12):")
        }while(parseInt(jamMasuk) < 1 || parseInt(jamMasuk) > 12)

        let waktuMasuk
        do {
            waktuMasuk = prompt("Silahkan Pilih Waktu Masuk: \n 1. AM \n 2. PM")
        } while (parseInt(waktuMasuk) < 1 || parseInt(waktuMasuk) > 2);

        let tanggalMasuk
        let checkTanggalMasuk = true
        do {
            tanggalMasuk = prompt("Silahkan Masukan Tanggal Masuk (Ex. DD/MM/YY):") // 09/08/21

            let arrTanggalMasuk = tanggalMasuk.split('/') // [DD, MM, YY]

            for(let i=0; i<arrTanggalMasuk.length; i++){
                if(arrTanggalMasuk[i].length !== 2){
                    checkTanggalMasuk = false
                }
            }

        } while (checkTanggalMasuk === false);

        // #####

        let checkValidationKeluar = true
        let jamKeluar
        let waktuKeluar
        let tanggalKeluar
        do {
            do{
                jamKeluar = prompt("Silahkan Keluaran Jam Keluar (Ex. 1-12):")
            }while(parseInt(jamKeluar) < 1 || parseInt(jamKeluar) > 12)

            do {
                waktuKeluar = prompt("Silahkan Pilih Waktu Keluar: \n 1. AM \n 2. PM")
            } while (parseInt(waktuKeluar) < 1 || parseInt(waktuKeluar) > 2);

            let checkTanggalKeluar = true
            do {
                tanggalKeluar = prompt("Silahkan Masukan Tanggal Keluar (Ex. DD/MM/YY):") // 09/08/21

                let arrTanggalKeluar = tanggalKeluar.split('/') // [DD, MM, YY]

                for(let i=0; i<arrTanggalKeluar.length; i++){
                    if(arrTanggalKeluar[i].length !== 2){
                        checkTanggalKeluar = false
                    }
                }

            } while (checkTanggalKeluar === false);

            // ##### Validasi Jam, Waktu & Tanggal

            if(waktuMasuk === waktuKeluar && tanggalMasuk.split('/')[0] === tanggalKeluar.split('/')[0]){ // - Jam Keluar Tidak Boleh < Jam Masuk Ketika di Tanggal & Waktu yg Sama
                if(parseInt(jamKeluar) < parseInt(jamMasuk)){
                    alert('Jam Keluar Tidak Boleh Kurang Dari Jam Masuk')
                    checkValidationKeluar = false
                }else{
                    checkValidationKeluar = true
                }
            }else if(tanggalKeluar.split('/')[0] < tanggalMasuk.split('/')[0]){ // - Tanggal Keluar Tidak Boleh < Tanggal Masuk
                alert('Tanggal Keluar Tidak Boleh Kurang Dari Tanggal Masuk')
                checkValidationKeluar = false
            }else{
                checkValidationKeluar = true
            }
        } while (checkValidationKeluar === false);

        // Step3. Hitung Lama Parkir
        jamMasuk = parseInt(jamMasuk)
        jamKeluar = parseInt(jamKeluar)
        let lamaParkir

        // 1. Apabila parkir di waktu yg sama & tanggal yg sama (Ex. 09:00AM - 11:00AM)
        // lamaParkir = jamKeluar - jamMasuk
        if(waktuMasuk === waktuKeluar && tanggalMasuk.split('/')[0] === tanggalKeluar.split('/')[0]){
            lamaParkir = jamKeluar - jamMasuk
        }

        // 2. Apabila parkir di waktu yg sama & tanggal yg berbeda (Ex. 09:00AM 16/8 - 05:00AM 17/8)
        // lamaParkir = jamKeluar + 24 - jamMasuk
        else if(waktuMasuk === waktuKeluar && tanggalMasuk.split('/')[0] !== tanggalKeluar.split('/')[0]){
            lamaParkir = jamKeluar + 24 - jamMasuk
        }

        // 3. Apabila parkir di waktu yg berbeda tapi di tanggal yg sama (Ex. 11:00AM - 01:00PM)
        // lamaParkir = (jamKeluar + 12) - jamMasuk ---> Masuk AM-PM
        else if(waktuMasuk !== waktuKeluar && tanggalMasuk.split('/')[0] === tanggalKeluar.split('/')[0]){
            lamaParkir = (jamKeluar + 12) - jamMasuk
        }

        // 4. Apabila parkir di waktu yg berbeda serta tanggal yg berbeda (Ex. 06:00PM 16/8 - 01:00AM 17/8)
        // lamaParkir = (JamKeluar+24) - (jamMasuk+12)
        // lamaParkir = (24 - (jamMasuk+12) + jamKeluar)
        else{
            lamaParkir = (24 - (jamMasuk + 12) + jamKeluar)
        }

        // Step4. Hitung Tarif Parkir Berdasarkan Lama Parkir
        // 1-3 Jam : 10000
        // > 3 Jam : 1500
        let tarif1 = 10000
        let tarif2 = 1500
        let tarifParkir 

        if(lamaParkir >= 1 && lamaParkir <= 3){
            tarifParkir = tarif1
        }else{
            tarifParkir = tarif1 + ((lamaParkir - 3) * tarif2)
        }

        // Step5. Terima Uang Pembayaran dari User
        let pembayaran

        do {
            pembayaran = prompt(`
            Total Tarif Parkir = ${lamaParkir} Jam = ${tarifParkir} \n
            Silahkan Masukan Uang Anda:
        `)
        } while (parseInt(pembayaran) < parseInt(tarifParkir));

        // Step6. Cetak Struk
        alert(`
            Terimakasih \n
            Total Parkir = ${tarifParkir} \n
            Total Bayar = ${pembayaran} \n
            ------------------------------   - \n
            Kembalian = ${pembayaran - tarifParkir}
        `)

    </script>
</body>
</html>