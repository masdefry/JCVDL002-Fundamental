<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market V1.4</title>
</head>
<body>
    <script>
        // Step1. Identifikasi Data
        // Nama Product, Harga Product, Stock Product, Cart

        let product = [["Apel", 10000, 10], ["Anggur", 15000, 15], ["Jeruk", 20000, 20]]
        let cart = [] // [[Apel, 5, 50000]]
        let menu 

        do{
            // Menampilkan Keranjang Belanja
            // Product x Qty = Total Price
            let userCart = ''
            if(cart.length !== 0){
                for(let i=0; i<cart.length; i++){
                for(let j=0; j<cart[i].length; j++){
                    if(j === 0){
                        userCart += cart[i][j]
                    }else if(j === 1){
                        userCart += ` x ${cart[i][j]} = `
                    }else if(j === 2){
                        userCart += `${cart[i][j]}`
                    } 
                }
            }
            }

            menu = prompt(`${userCart} \n Pilih Menu \n 1. Lihat Buah \n 2. Tambah Buah \n 3. Menghapus Buah \n 4. Membeli Buah \n 5. Checkout \n 6.Exit`)

            if(parseInt(menu) === 1){ // Menu Menampilkan Daftar Buah
                let namaProduct = ''

                for(let i=0; i<product.length; i++){        // i=0: true  
                    for(let j=0; j<product[i].length; j++){ // j=0: true ---> j=1: true ---> j=2: 
                        if(j===0){
                            namaProduct += `Buah ${product[i][j]}, `
                        }else if(j===1){
                            namaProduct += `Harga   : Rp.${product[i][j]}, `
                        }else if(j===2){
                            namaProduct += `Stock   : ${product[i][j]}`
                        }
                    }
                    namaProduct += '\n'
                }

                alert(namaProduct)
            }else if(parseInt(menu) === 2){ // Menu Menambah Buah
                // ##### Validasi Nama Product #####
                let alphabet = 'abcdefghijklmnopqrstuvwxyz'
                let checkNameValidation = true // true ---> false ---> true ---> ... ---> true
                let newProductName
                do {
                    newProductName = prompt("Masukan Nama Buah:") // Semangka || S3mangka
                    
                    for(let i=0; i<newProductName.length; i++){
                        if(!alphabet.includes(newProductName[i].toLowerCase())){
                            checkNameValidation = false
                            alert("Inputan Tidak Sesuai! Masukan Huruf A-Z / a-z")
                            break;
                        }else{
                            checkNameValidation = true
                        }
                    }
                } while (checkNameValidation === false);

                // ##### Validasi Harga Product #####
                let checkHargaValidation = true
                while(checkHargaValidation === true){
                    let newProductPrice = prompt("Masukan Harga Buah:") // "10000"

                    for(let i=0; i<newProductPrice.length; i++){
                        if(parseInt(newProductPrice[0]) < 1){ // Ketika digit pertama < 1 
                            alert('Inputan Tidak Sesuai. Masukan Harga Dengan Benar!')
                            break;
                        }

                        if(parseInt(newProductPrice[i]) >= 0){ 
                            checkHargaValidation = false
                        }else{
                            checkHargaValidation = true
                            alert('Inputan Tidak Sesuai. Masukan Harga Dengan Benar!')
                            break;
                        }
                    }
                }

                // ##### Validasi Stock Product #####
                let checkStockValidation = true
                while(checkStockValidation === true){
                    let newProductStock = prompt("Masukan Stock Buah:")

                    for(let i=0; i<newProductStock.length; i++){
                        if(parseInt(newProductStock[0]) < 1){
                            alert('Inputan Tidak Sesuai. Masukan Stock Dengan Benar!')
                            break;
                        }

                        if(parseInt(newProductStock[i]) >= 0){
                            checkStockValidation = false
                        }else{
                            checkStockValidation = true
                            alert('Inputan Tidak Sesuai. Masukan Stock Dengan Benar!')
                            break;
                        }
                    }
                }

                product.push([newProductName, newProductPrice, newProductStock]) // [..., ..., ...]
            }else if(parseInt(menu) === 3){ // Menu Menghapus Buah
                let namaProduct = ''

                for(let i=0; i<product.length; i++){        // i=0: true  
                    for(let j=0; j<product[i].length; j++){ // j=0: true ---> j=1: true ---> j=2: 
                        if(j===0){
                            namaProduct += `${i+1} Buah ${product[i][j]}, `
                        }else if(j===1){
                            namaProduct += `Harga   : Rp.${product[i][j]}, `
                        }else if(j===2){
                            namaProduct += `Stock   : ${product[i][j]}`
                        }
                    }
                    namaProduct += '\n'
                }

                // ##### Validasi Apakah Nomor Buah Terdapat di Dalam List Product
                let checkProductValidation = true
                do {
                    let productToDelete = prompt(` 
                    ${namaProduct} \n
                    Masukan Nomor Buah yang Akan di Hapus
                    `) 

                    if(parseInt(productToDelete) > 0){
                        if(parseInt(productToDelete)-1 > product.length-1){
                            checkProductValidation = false
                            alert("Nomor Buah Tidak Ditemukan! Masukan Nomor Buah yg Sesuai dengan List Data di Atas")
                        }else{
                            product.splice(productToDelete-1, 1)
                            checkProductValidation = true
                            alert('Product Berhasil Dihapus')
                        }
                    }else{
                        checkProductValidation = false
                    }
                } while (checkProductValidation === false);
            }else if(parseInt(menu) === 4){ // Menu Untuk Membeli Buah
                let namaProduct = ''

                for(let i=0; i<product.length; i++){        // i=0: true  
                    for(let j=0; j<product[i].length; j++){ // j=0: true ---> j=1: true ---> j=2: 
                        if(j===0){
                            namaProduct += `${i+1} Buah ${product[i][j]}, `
                        }else if(j===1){
                            namaProduct += `Harga   : Rp.${product[i][j]}, `
                        }else if(j===2){
                            namaProduct += `Stock   : ${product[i][j]}`
                        }
                    }
                    namaProduct += '\n'
                }

                let checkProductToBuyValidation = false

                do {
                    let productToBuy = prompt(` 
                    ${namaProduct} \n
                    Masukan Nomor Buah yang Akan di Beli
                    `)

                    if(parseInt(productToBuy)-1 > product.length-1){
                        checkProductValidation = false
                        alert("Nomor Buah Tidak Ditemukan! Masukan Nomor Buah yg Sesuai dengan List Data di Atas")
                    }else{
                        checkProductToBuyValidation = true
                        let productPrice = product[productToBuy-1][1]
                        productToBuy = product[productToBuy-1][0]
                        let qtyToBuy = prompt('Masukan Quantity yang Akan di Beli')

                        cart.push([productToBuy, qtyToBuy, productPrice * qtyToBuy])
                    }
                } while (checkProductToBuyValidation === false);
            }else if(parseInt(menu) === 5){
                if(cart.length === 0){
                    alert("Cart Masih Kosong! Silahkan Pilih Product Terlebih Dahulu")
                }else{
                    // [[Apel, 5, 50000], [Jeruk, 3, 60000]]
                    let grandTotal = 0 // i=0 ---> 50000 || i=1 ---> 110000
                    for(let i=0; i<cart.length; i++){ // i=0 || i=1
                        grandTotal += cart[i][2] // cart[0][2]: 50000 || cart[1][2]: 60000
                    }

                    let uangDibayarkan = prompt(`${userCart} \n Grand Total = ${grandTotal} \n Masukan Jumlah Uang Anda:`)

                    if(uangDibayarkan < grandTotal){
                        alert("Transaksi Dibatalkan! Uang Anda Masih Kurang!")
                    }else{
                        cart = []
                        alert(`
                            Uang Kembalian = ${uangDibayarkan - grandTotal} \n
                            Transaksi Dikonfimasi! 
                        `)
                    }
                }
            }

        }while(parseInt(menu) != 6)

        // 

    //     Tugas1: Lakukan validasi untuk inputan user ketika akan menambah data buah (nama, harga, stock)
    //     Tugas2: Lakukan validasi ketika user memilih buah yg akan di hapus
    //     Tugas3: Lakukan validasi ketika user memilih buah yg akan dibeli
    //     Tugas4: Buatlah Menu Checkout, Uang yg dibayarkan < grand total -> Transaksi dibatalkan, Uang yg dibayarkan >= grand total -> Transaksi berhasil & tampilkan struk
    // </script>
</body>
</html>