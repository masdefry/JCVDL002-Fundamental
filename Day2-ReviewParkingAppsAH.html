<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parking Apps</title>
</head>
<body>
    <script>
        // Step1. Identifikasi Data
        // JamMasuk, WaktuMasuk (AM/PM), TanggalMasuk || JamKeluar, WaktuKeluar(AM/PM), TanggalKeluar
        // TarifAwal, TarifBerikutnya
        // LamaParkir
        // HitungTarifParkir
        // TotalPembayaran
        // Struk

        // Step2. Menerima Input & Memvalidasi Inputan User
        //      - Validasi Jam, Waktu, Tanggal
        //      - Validasi Tanggal Keluar TIDAK BOLEH < Tanggal Masuk
        //      - Validasi Lama Parkir TIDAK BOLEH > 24 Jam

        // ##### Menerima Input Masuk
        let jamMasuk
        do {
            jamMasuk = prompt("Masukan Jam Masuk (Ex. 1-12)")
        } while (parseInt(jamMasuk) < 1 || parseInt(jamMasuk) > 12);

        let waktuMasuk
        do {
            waktuMasuk = prompt("Masukan Waktu Masuk : \n 1. AM \n 2. PM")
        } while (parseInt(waktuMasuk) < 1 || parseInt(waktuMasuk) > 2);

        let tanggalMasuk
        let checkTanggalMasuk = false // i=0 true ---> i=1 false ---> i=2 true
        do {
            tanggalMasuk = prompt("Masukan Tanggal Masuk (Ex. DD/MM/YY)") // 18/08/21
            let tanggalMasukSplit = tanggalMasuk.split("/") // ["18", "08", "21"]

            for(let i=0; i<tanggalMasukSplit.length; i++){
                if(tanggalMasukSplit[i].length !== 2){ // false
                    checkTanggalMasuk = false
                    break;
                }else{
                    checkTanggalMasuk = true
                }

            }
        } while (checkTanggalMasuk === false);

        // ##### Menerima Input Keluar
        let checkValidasiKeluar = true
        do {
            let jamKeluar
            do {
                jamKeluar = prompt("Masukan Jam Keluar (Ex. 1-12)")
            } while (parseInt(jamKeluar) < 1 || parseInt(jamKeluar) > 12);

            let waktuKeluar
            do {
                waktuKeluar = prompt("Masukan Waktu Keluar : \n 1. AM \n 2. PM")
            } while (parseInt(waktuKeluar) < 1 || parseInt(waktuKeluar) > 2);

            let TanggalKeluar
            let tanggalKeluarSplit
            let checkTanggalKeluar = false // i=0 true ---> i=1 false ---> i=2 true
            do {
                TanggalKeluar = prompt("Masukan Tanggal Keluar (Ex. DD/MM/YY)") // 18/08/21
                tanggalKeluarSplit = TanggalKeluar.split("/") // ["18", "08", "21"]

                for(let i=0; i<tanggalKeluarSplit.length; i++){
                    if(tanggalKeluarSplit[i].length !== 2){ // false
                        checkTanggalKeluar = false
                        break;
                    }else{
                        checkTanggalKeluar = true
                    }

                }
            } while (checkTanggalKeluar === false);

            let tanggalMasukSplit = tanggalMasuk.split("/")

            // ##### Validasi Apabila Tanggal Keluar < Tanggal Masuk
            if(parseInt(tanggalKeluarSplit[0]) < parseInt(tanggalMasukSplit[0])){
                checkValidasiKeluar = false
                alert("Tanggal Keluar Tidak Boleh < Tanggal Masuk")
            }else{
                checkValidasiKeluar = true
            }

            // ##### Validasi Lama Parkir TIDAK BOLEH > 24 Jam
            // Step3. Lama Parkir
            var lamaParkir
            //      1. Parkir di Waktu yg Sama & Tanggal yg Sama
            //          lamaParkir = jamKeluar - jamMasuk
            if(parseInt(waktuMasuk) === parseInt(waktuKeluar) && tanggalMasukSplit[0] === tanggalKeluarSplit[0]){
                lamaParkir = parseInt(jamKeluar) - parseInt(jamMasuk)
            }
            //      2. Parkir di Waktu yg Sama & Tanggal yg Berbeda
            //          lamaParkir = 24 - (jamMasuk - jamKeluar)
            else if(parseInt(waktuMasuk) === parseInt(waktuKeluar) && parseInt(tanggalMasukSplit[0]) !== parseInt(tanggalKeluarSplit[0])){
                lamaParkir = 24 - (parseInt(jamMasuk) - parseInt(jamKeluar))
            }
            //      3. Parkir di Waktu yg Berbeda & Tanggal yg Sama
            //          lamaParkir = (12 + jamKeluar) - jamMasuk

            //      4. Parkir di Waktu yg Berbeda & Tanggal yg Berbeda
            //          lamaParkir = (12 + jamKeluar) - jamMasuk
            else{
                lamaParkir = (12 + parseInt(jamKeluar)) - parseInt(jamMasuk)
            }

            alert(lamaParkir)

            if(lamaParkir > 24){
                checkValidasiKeluar = false
                alert('Lama Parkir Tidak Boleh > 24 Jam! Silahkan Hubungi Petugas!')
            }else{
                checkValidasiKeluar = true
            }
        } while (checkValidasiKeluar === false);

        // Step4. Hitung Tarif Parkir
        // 3 Jam Pertama    : 10000
        // 1 Jam Berikutnya : 1500
        let tarifPertama = 10000
        let tarifBerikutnya = 1500

        let tarifParkir

        if(lamaParkir <= 3){
            tarifParkir = tarifPertama
        }else{
            tarifParkir = tarifPertama + ((lamaParkir - 3) * tarifBerikutnya)
        }

        // Step5. Pembayaran
        let pembayaranUser = prompt(
            `
                Lama Parkir     = ${lamaParkir} \n
                Tarif Parkir    = ${tarifParkir} \n
                Masukan Uang Pembayaran Anda    = 
            `
        )

        // Step6. Struk
        if(pembayaranUser < tarifParkir){
            alert("Transaksi Dibatalkan!")
        }else{
            alert(`
                Transaksi Berhasil! \n
                Lama Parkir     = ${lamaParkir} \n
                Tarif Parkir    = ${tarifParkir} \n
                ----------------------------------- \n
                Uang Anda       = ${pembayaranUser} \n
                Kembalian       = ${pembayaranUser - tarifParkir}
            `)
        }
    </script>
</body>
</html>